{"version":3,"file":"router.js","sourceRoot":"","sources":["../../src/integrations/router.ts"],"names":[],"mappings":";;;AAAA,qCAAsE;AAUtE,gBAAgB;AAChB;IAcE;;OAEG;IACH,gBAAmB,OAA4B;QAhB/C;;WAEG;QACI,SAAI,GAAW,MAAM,CAAC,EAAE,CAAC;QAc9B,IAAI,CAAC,QAAQ,sBACX,MAAM,EAAE,IAAI,IACT,OAAO,CACX,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,0BAAS,GAAhB;QAAA,iBA2BC;QA1BC,8BAAuB,CAAC,UAAC,KAAY;YACnC,IAAI,oBAAa,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC1C,IAAI,KAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;oBACxB,IAAI;wBACF,IAAM,OAAO,GAAG,eAAe,EAAE,CAAC,GAAG,CACnC,UAAC,KAAyC,IAAK,OAAA,CAAC;4BAC9C,KAAK,EAAE,KAAK,CAAC,KAAK;4BAClB,OAAO,EAAE,KAAK,CAAC,OAAO;yBACvB,CAAC,EAH6C,CAG7C,CACH,CAAC;wBAEF,6CACK,KAAK,KACR,KAAK,wCACA,KAAK,CAAC,KAAK,KACd,OAAO,SAAA,OAET;qBACH;oBAAC,OAAO,CAAC,EAAE;wBACV,OAAO,CAAC,IAAI,CAAC,0CAAwC,CAAG,CAAC,CAAC;qBAC3D;iBACF;aACF;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CAAC;IACL,CAAC;IAhDD;;OAEG;IACW,SAAE,GAAW,QAAQ,CAAC;IA8CtC,aAAC;CAAA,AAvDD,IAuDC;AAvDY,wBAAM","sourcesContent":["import { addGlobalEventProcessor, getCurrentHub } from \"@sentry/core\";\nimport { Event, Integration } from \"@sentry/types\";\n\ndeclare const getCurrentPages: any;\n\n/** JSDoc */\ninterface RouterIntegrations {\n  enable?: boolean;\n}\n\n/** UserAgent */\nexport class Router implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = Router.id;\n\n  /**\n   * @inheritDoc\n   */\n  public static id: string = \"Router\";\n\n  /** JSDoc */\n  private readonly _options: RouterIntegrations;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options?: RouterIntegrations) {\n    this._options = {\n      enable: true,\n      ...options,\n    };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event) => {\n      if (getCurrentHub().getIntegration(Router)) {\n        if (this._options.enable) {\n          try {\n            const routers = getCurrentPages().map(\n              (route: { route: string; options: object }) => ({\n                route: route.route,\n                options: route.options,\n              })\n            );\n\n            return {\n              ...event,\n              extra: {\n                ...event.extra,\n                routers,\n              },\n            };\n          } catch (e) {\n            console.warn(`sentry-miniapp get router info fail: ${e}`);\n          }\n        }\n      }\n\n      return event;\n    });\n  }\n}\n"]}